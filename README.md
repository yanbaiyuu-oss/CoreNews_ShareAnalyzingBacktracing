# 📈 多因子量化选股与技术分析报告系统

## 🌟 项目概览 (Project Overview)

本项目是一个高性能、自动化运行的 Python 数据管道，旨在通过**多因子量化模型**对 A 股市场进行深度分析和筛选。
系统整合了基本面研究预测、市场情绪追踪及多维度技术指标，自动生成一份结构化、可操作的 Excel 报告，为投资决策提供系统性的量化支持。

**核心价值：** 将传统的主观投研流程转化为可复现、可回溯的自动化量化筛选流程，确保分析结果的客观性和时效性。

## 🏛️ 系统架构与工作流 (System Architecture)

本项目采用模块化、面向对象的设计模式，主要由三大核心组件构成：

| 组件名称 | 类/模块 | 核心职能 | 技术实现细节 |
| :--- | :--- | :--- | :--- |
| **数据采集层** | `DataFetcher` | 负责所有数据的并行获取，并实现**磁盘缓存机制**（Data Caching）以提高效率和稳定性。 | `akshare`, `ThreadPoolExecutor` |
| **量化处理层** | `DataProcessor` | 负责数据的清洗、标准化、因子计算、信号提取及**多因子评分汇总**。这是系统的决策核心。 | `pandas`, `pandas_ta` (指标计算), Python 原生逻辑 |
| **报告输出层** | `ExcelReporter` | 负责将多因子筛选结果以结构化的多工作表形式输出为 Excel 报告，并实现**无超链接纯文本 URL 写入**。 | `pandas.ExcelWriter`, `xlsxwriter` |

### 运行流程概览

1.  **数据初始化：** `DataFetcher` 并行抓取实时行情、研报预测、资金流向等。
2.  **指标计算：** 批量获取历史 K 线数据（120天），`DataProcessor` 在此基础上计算所有技术指标（**MACD, ADX, BOLL, RSI, CCI, MA**）。
3.  **因子信号提取：** 根据预设的量化策略（如 MACD 金叉、ADX > 25）提取买入信号。
4.  **多因子加权评分：** 将所有有效信号进行汇总，对符合多个条件的股票进行评分。
5.  **报告生成：** `ExcelReporter` 输出最终的量化报告，涵盖筛选结果和所有辅助数据。

    📈 指标汇总表：仅列出符合至少一个条件的股票，并用符合条件数量进行评分排序。

    🚦 条件格式高亮：

    红色高亮：MACD金叉、RSI金叉、ADX趋势强势（代表积极追逐信号）。
  
    绿色高亮：CCI超卖买入（代表底部捕捉信号）。
  
    蓝色高亮：量价齐升（代表资金驱动力强）。

## 📊 多因子模型与信号策略 (Multi-Factor Model & Signals)

本系统采用组合型多因子策略，旨在从**基本面驱动、趋势追踪、动量捕捉**和**波动率管理**四个维度进行筛选：

### 1. 动量与趋势因子 (Momentum & Trend)

| 因子名称 | 指标 | 筛选策略 (买入信号) | 策略理念 |
| :--- | :--- | :--- | :--- |
| **短期动量** | MACD | MACD 柱线 (DIF) 上穿信号线 (DEA)，即“MACD 金叉”。 | 捕捉短期多头力量的爆发点。 |
| **相对强弱** | RSI (6 & 14) | RSI (6日) 上穿 RSI (14日) 且 RSI 14 处于 **[60, 80] 区间**。 | 确认短期强势，规避超买风险。 |
| **均线系统** | MA (20/60/90) | 当前价 > $MA_{20}$，且满足 ($MA_{20}$ > $MA_{60}$) 或 ($MA_{60}$ > $MA_{90}$)。（**多头排列**） | 确认中期趋势为上升趋势或处于潜在上升趋势中。 |

### 2. 趋势强度与波动率因子 (Trend Strength & Volatility)

| 因子名称 | 指标 | 筛选策略 (买入/确认信号) | 策略理念 |
| :--- | :--- | :--- | :--- |
| **趋势强度** | **ADX (14日)** | **$ADX > 25$**。 | 确认市场处于明确的趋势期，避免在震荡市中交易。 |
| **波动率反转** | **BOLL (20, 2)** | 价格位于下轨线附近（略高于下轨线），且带宽/中轨线 $< 5\%$。 | 捕捉极低波动率后的价格反转机会，遵循“布林带收窄预示着大行情”的原则。 |
| **超卖反弹** | CCI (14日) | $CCI$ 从低于 $-100$ 的区域上穿 $-100$ 信号线。 | 识别极度超卖后的技术性反弹机会。 |

### 3. 基本面与市场因子 (Fundamental & Market)

| 因子名称 | 数据来源 | 筛选标准 |
| :--- | :--- | :--- |
| **基本面驱动** | 主力研报盈利预测 | 近六个月内“买入”或“增持”评级机构数量 $\ge 2$。 |
| **市场情绪** | 连涨/强势股池 | 股票出现在“连续上涨”或“强势股池”排行榜中。 |
| **市场热点** | 行业板块/资金流向 | 参照行业板块涨跌幅排名前 10 的成分股及市场资金流向数据。 |

## 🛠️ 技术栈与环境要求

| 类别 | 库/工具 | 用途 |
| :--- | :--- | :--- |
| **数据源** | `akshare` | 国内股票、研报、资金流向等数据接口。 |
| **量化计算** | `pandas_ta` | 高级技术分析指标（MACD, ADX, BOLL等）计算。 |
| **数据处理** | `pandas`, `numpy` | 数据结构处理、清洗、对齐、批量计算。 |
| **报告生成** | `xlsxwriter` | 高效、专业的 Excel 报告写入与格式化。 |
| **并发处理** | `concurrent.futures` | 实现历史 K 线数据并行下载，加速整体流程。 |

### 环境配置

1.  **Python 版本：** 推荐 Python 3.8+
2.  **依赖安装：** pip install akshare pandas pandas_ta xlsxwriter

🚀 使用指南 (Installation & Usage)**
1. 克隆项目
git clone [您的项目URL]
cd [您的项目文件夹]

2. 运行分析流程
python ShareBasic.py

3. 报告输出
系统将在执行后自动生成 Excel 报告
路径默认位于用户下载目录下的特定文件夹中：
~/Downloads/CoreNews_Reports/主力研报筛选_YYYYMMDD.xlsx
